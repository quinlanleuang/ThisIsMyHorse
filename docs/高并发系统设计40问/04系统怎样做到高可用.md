- 高可用是指系统具备较高的无故障运行能力

# 可用性度量
- MTBF（Mean Time Between Failure），平均故障间隔，即两次故障之间的jiange
- MTTR（Mean Time To Repair），故障的平均恢复时间，
- Availability = MTBF/(MTBF+MTTR)
![](https://static001.geekbang.org/resource/image/73/75/73a87a9bc14a27c9ec9dfda1b72e1e75.jpg)
- 一般核心业务需要达到4个九，非核心业务最多容忍3个九
  
# 高可用系统设计的思路
## 系统设计
- 在设计系统时，要把发生故障作为一个重要的考虑点，如何自动化地发现故障，故障发生之后如何处理
- failover（故障转移）
  - 完全对等的节点之间故障转移
  - 不对等的节点之间故障转移，通过心跳检测发现主节点故障时，备节点使用分布式一致性算法选主
- 系统间调用超时控制
  - 当某一个服务有较大延迟时，调用方会阻塞在这次调用，当存在大量这种阻塞请求时，调用方就会因为用尽资源而挂掉
  - 通过收集日志，统计比如99%分位时长是怎样的，然后依据这个时间来指定超时时间
- 降级
  - 为了保证核心服务的稳定而牺牲非核心服务的做法
- 限流
  - 通过对并发请求进行限速，比如限制单机只能处理每秒1000次请求

## 系统运维
- 重视变更管理，提供必要的回滚方案
- 灰度发布，系统的变更不是一次性推到线上，而是以机器为维度，先推一部分，进行观察一段时间，再完全推。灰度发布是
- 故障演练，对系统使用一些破坏的手段，观察出现故障时，系统的表现是怎样的，从而发现系统中存在的，潜在的可用性问题
  

